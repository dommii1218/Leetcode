select round((sum(if(datediff(event_date,first_login)=1,1,0))/count(distinct player_id)),2) fraction
from (select *, min(event_date) over(partition by player_id) first_login
      from activity) t
      
SELECT ROUND(SUM(IF(DATEDIFF(event_date, firstLogin)=1,1,0))*1.0 / COUNT(DISTINCT(player_id)),2) AS fraction
FROM (SELECT *, MIN(event_date) OVER (PARTITION BY player_id) AS firstLogin FROM Activity) AS a
